%% Polymod Study Social Contact Matrices (Mossong et al.)

% This script creates Matlab matrices from the of contacts per day by age 
% based on 8-site European Study included in the POLYMOD study. Each matrix
% is read in, made symmetric, and the average, minimum, and maximum values
% for the contact matrices required for the hepatitis C transmission 
% model in Gicquelais et al. are created.

% Full citation of the Mossong et al. study:
% Mossong J et al. (2008). Social Contacts and Mixing Patterns Relevant 
% to the Spread of Infectious Diseases. PLoS Med, 5(3): e74.

% Polymod Age groups (and matrix rows/columns) include:
% 00-04  05-09	10-14	15-19	20-24	25-29	30-34	35-39	40-44	
% 45-49	 50-54  55-59	60-64	65-69	70+;

%% Belgium
polymod = [1.36	0.66	0.43	0.28	0.1	0.44	0.8	0.74	0.18	0.22	0.39	0.46	0.34	0.32	0.11;
0.74	3.28	0.78	0.68	0.58	0.09	0.68	0.69	0.21	0.06	0.39	0.23	0.07	0.59	0.15;
0.42	0.76	5.6	0.81	0.46	0.07	0.34	1.13	0.89	0.26	0.31	0.13	0.1	0.18	0.3;
0.14	0.25	1.34	6.39	2.02	0.35	0.55	0.44	0.92	0.76	0.33	0.27	0.07	0.09	0.33;
0.34	0.17	0.7	1.67	4.4	0.91	0.84	0.46	0.55	0.8	0.93	0.71	0.27	0.23	0.07;
1.08	0.61	0.28	0.72	1.77	2.28	1.16	1.15	0.89	1.08	1.3	1.13	0.54	0.27	0.3;
1.46	1.29	0.57	0.37	1.29	1.37	2.07	1.46	0.58	1.06	0.74	1.77	1.2	0.41	0.3;
0.77	1.2	1.15	0.73	0.56	1.09	2.18	1.67	1.29	1.46	0.83	1.27	0.76	0.91	0.52;
0.38	0.82	1.15	1.15	0.96	0.58	1.57	1.64	1.42	1	1.09	1.37	1.07	0.73	0.56;
0.26	0.41	0.9	1.27	1.17	1.05	0.77	0.82	1.42	1.98	1.13	1.06	0.83	0.27	0.93;
0.41	0.3	0.21	0.51	0.77	0.77	0.59	0.69	0.82	0.86	1.48	1.46	0.51	0.36	0.59;
0.39	0.3	0.34	0.2	0.35	0.4	0.86	0.28	0.24	0.72	1.04	1.58	0.88	0.36	0.41;
0.24	0.29	0.34	0.09	0.13	0.14	0.39	0.51	0.29	0.18	0.85	0.81	1.41	0.59	0.93;
0.16	0.16	0.16	0.13	0.17	0.07	0.32	0.26	0.24	0.38	0.26	0.42	0.88	0.91	0.59;
0.23	0.2	0.3	0.15	0.31	0.3	0.43	0.33	0.82	0.92	0.8	1.08	1.12	1.36	1.48];

%Make symmetric c matrix;     
c=[polymod(4,4) (polymod(4,5)+polymod(5,4))/2 (polymod(4,6)+polymod(6,4))/2 (polymod(4,7)+polymod(7,4))/2;
   0 polymod(5,5) (polymod(5,6)+polymod(6,5))/2 (polymod(5,7)+polymod(7,5))/2;
   0 0 polymod(6,6) (polymod(6,7)+polymod(7,6))/2;
   0 0 0 polymod(7,7)];
c1 = c+c'-diag(diag(c));

%% Germany

polymod = [1.9	0.36	0.09	0.04	0.08	0.27	0.46	0.2	0.2	0.09	0.19	0.07	0.1	0.03	0.07;
0.81	2.25	0.35	0.18	0.03	0.17	0.26	0.49	0.23	0.09	0.2	0.11	0.14	0.11	0.27;
0.34	0.61	3.58	0.69	0.12	0.16	0.14	0.62	0.67	0.35	0.16	0.07	0.07	0.18	0.34;
0.42	0.42	0.93	4.19	0.9	0.28	0.19	0.46	1.11	1.21	0.27	0.26	0.11	0.15	0.49;
0.56	0.24	0.25	1.29	2.59	1.43	0.44	0.22	0.57	0.45	0.47	0.33	0.19	0.15	0.3;
0.62	0.43	0.25	0.36	1.14	1.79	0.98	0.3	0.38	0.57	0.6	0.45	0.32	0.19	0.24;
1.2	0.66	0.34	0.22	0.45	1.09	1.49	0.74	0.57	0.59	0.54	0.61	0.31	0.32	0.41;
0.87	0.77	0.65	0.6	0.45	0.77	1.18	1.43	0.95	0.7	0.58	0.57	0.36	0.42	0.5;
0.49	0.72	0.97	0.69	0.47	0.6	0.98	1.03	1.23	1.05	0.71	0.59	0.49	0.62	0.52;
0.4	0.38	0.44	0.68	0.63	0.77	0.32	0.59	0.93	1.23	0.99	0.62	0.44	0.38	0.37;
0.38	0.23	0.37	0.39	0.41	0.59	0.67	0.36	0.47	0.82	1.18	0.79	0.4	0.45	0.38;
0.26	0.26	0.15	0.26	0.26	0.59	0.35	0.28	0.22	0.41	0.79	1.12	0.75	0.35	0.31;
0.27	0.22	0.19	0.12	0.11	0.49	0.42	0.36	0.32	0.28	0.42	0.54	0.85	0.8	0.43;
0.19	0.18	0.19	0.15	0.08	0.23	0.19	0.3	0.2	0.15	0.18	0.3	0.52	0.91	0.44;
0.38	0.63	0.24	0.14	0.19	0.28	0.21	0.22	0.4	0.26	0.28	0.34	0.37	1.3	0.76];

%Make symmetric c matrix;     
c=[polymod(4,4) (polymod(4,5)+polymod(5,4))/2 (polymod(4,6)+polymod(6,4))/2 (polymod(4,7)+polymod(7,4))/2;
   0 polymod(5,5) (polymod(5,6)+polymod(6,5))/2 (polymod(5,7)+polymod(7,5))/2;
   0 0 polymod(6,6) (polymod(6,7)+polymod(7,6))/2;
   0 0 0 polymod(7,7)];
c2 = c+c'-diag(diag(c));

%% Finland

polymod=[1.97	1.32	0.36	0.3	0.29	0.75	0.92	0.73	0.2	0.23	0.25	0.13	0.4	0.08	0.23;
1.09	4.8	1.22	0.36	0.02	0.37	0.43	0.77	0.4	0.39	0.22	0.12	0.18	0.17	0.04;
0.4	1.57	8.48	1.55	0.21	0.05	0.42	0.81	0.88	0.63	0.2	0.13	0.08	0.25	0.08;
0.21	0.23	1.04	4.56	1.09	0.35	0.1	0.35	0.6	0.66	0.49	0.17	0.08	0.09	0.15;
0.18	0.33	0.22	1.09	2.71	1.49	0.7	0.71	0.57	0.89	0.59	0.32	0.27	0.28	0.15;
0.71	0.4	0.34	0.51	1.45	2.09	0.95	1.39	0.77	0.55	1	0.72	0.45	0.39	0.35;
0.88	0.87	0.54	0.44	0.79	1.3	1.57	1.58	0.83	1	1.15	0.88	0.69	0.39	0.15;
0.84	1.01	0.78	0.58	0.5	1.05	1.25	2.06	1	0.84	0.71	0.83	0.69	0.36	0.31;
0.6	1.09	1.39	0.72	0.6	0.81	0.88	1.71	2.08	1.45	1.32	1.07	0.63	0.33	0.46;
0.49	0.52	0.81	1.17	0.62	0.84	0.9	1.18	1.5	1.33	1.49	0.92	0.47	0.3	0.23;
0.44	0.47	0.48	0.53	0.62	1.02	0.8	1.4	1.58	1.13	1.64	1.45	0.6	0.36	0.35;
0.33	0.29	0.21	0.39	0.33	0.49	0.78	0.5	0.58	0.55	1.46	1.28	0.82	0.5	0.23;
0.38	0.25	0.11	0.11	0.07	0.25	0.52	0.35	0.18	0.42	0.66	0.52	1.27	0.58	0.46;
0.19	0.22	0.08	0.07	0.09	0.09	0.13	0.21	0.25	0.13	0.19	0.27	0.53	0.77	0.81;
0.15	0.19	0.21	0.15	0.12	0.14	0.25	0.23	0.43	0.3	0.37	0.4	0.6	0.88	1.69];

%Make symmetric c matrix;     
c=[polymod(4,4) (polymod(4,5)+polymod(5,4))/2 (polymod(4,6)+polymod(6,4))/2 (polymod(4,7)+polymod(7,4))/2;
   0 polymod(5,5) (polymod(5,6)+polymod(6,5))/2 (polymod(5,7)+polymod(7,5))/2;
   0 0 polymod(6,6) (polymod(6,7)+polymod(7,6))/2;
   0 0 0 polymod(7,7)];
c3 = c+c'-diag(diag(c));
%% Great Britain


polymod=[1.92	0.65	0.41	0.24	0.46	0.73	0.67	0.83	0.24	0.22	0.36	0.20	0.20	0.26	0.13;
0.95	6.64	1.09	0.73	0.61	0.75	0.95	1.39	0.90	0.16	0.30	0.22	0.50	0.48	0.20;
0.48	1.31	6.85	1.52	0.27	0.31	0.48	0.76	1.00	0.69	0.32	0.44	0.27	0.41	0.33;
0.33	0.34	1.03	6.71	1.58	0.73	0.42	0.56	0.85	1.16	0.70	0.30	0.20	0.48	0.63;
0.45	0.30	0.22	0.93	2.59	1.49	0.75	0.63	0.77	0.87	0.88	0.61	0.53	0.37	0.33;
0.79	0.66	0.44	0.74	1.29	1.83	0.97	0.71	0.74	0.85	0.88	0.87	0.67	0.74	0.33;
0.97	1.07	0.62	0.50	0.88	1.19	1.67	0.89	1.02	0.91	0.92	0.61	0.76	0.63	0.27;
1.02	0.98	1.26	1.09	0.76	0.95	1.53	1.50	1.32	1.09	0.83	0.69	1.02	0.96	0.20;
0.55	1.00	1.14	0.94	0.73	0.88	0.82	1.23	1.35	1.27	0.89	0.67	0.94	0.81	0.80;
0.29	0.54	0.57	0.77	0.97	0.93	0.57	0.80	1.32	1.87	0.61	0.80	0.61	0.59	0.57;
0.33	0.38	0.40	0.41	0.44	0.85	0.60	0.61	0.71	0.95	0.74	1.06	0.59	0.56	0.57;
0.31	0.21	0.25	0.33	0.39	0.53	0.68	0.53	0.55	0.51	0.82	1.17	0.85	0.85	0.33;
0.26	0.25	0.19	0.24	0.19	0.34	0.40	0.39	0.47	0.55	0.41	0.78	0.65	0.85	0.57;
0.09	0.11	0.12	0.20	0.19	0.22	0.13	0.30	0.23	0.13	0.21	0.28	0.36	0.70	0.60;
0.14	0.15	0.21	0.10	0.24	0.17	0.15	0.41	0.50	0.71	0.53	0.76	0.47	0.74	1.47];
     
%Make symmetric c matrix;     
c=[polymod(4,4) (polymod(4,5)+polymod(5,4))/2 (polymod(4,6)+polymod(6,4))/2 (polymod(4,7)+polymod(7,4))/2;
   0 polymod(5,5) (polymod(5,6)+polymod(6,5))/2 (polymod(5,7)+polymod(7,5))/2;
   0 0 polymod(6,6) (polymod(6,7)+polymod(7,6))/2;
   0 0 0 polymod(7,7)];
c4 = c+c'-diag(diag(c));

%% Italy

polymod = [4.68	1.04	0.2	0.11	0.58	0.11	0.88	0.88	0.75	1.08	0.17	0.43	0.43	0.25	0.23;
1.64	9.23	1.25	0.24	0.19	0.24	0.86	0.95	1	0.92	1.07	1.12	0.28	0.32	0.33;
0.4	1.84	14.56	1.26	0.43	0.34	0.36	0.39	0.92	0.67	3.15	1.31	1.34	0.18	1.43;
0.19	0.23	2.59	17.53	1.09	0.82	0.56	0.7	1.31	2.22	2.52	0.43	0.83	0.14	0.97;
0.24	0.35	0.65	1.6	4.96	3.42	0.88	0.75	1.19	0.67	0.74	0.8	0.64	0.21	0.37;
0.62	0.54	0.46	0.87	3.04	3.45	1.66	1.52	1.14	1	1.24	1.18	1.15	0.61	1.1;
0.97	0.77	0.52	0.53	1.4	2.97	2.54	2.32	1.95	1.77	1.02	1.18	1.45	1.14	0.93;
1.29	1.35	0.95	0.67	1.17	1.55	2.42	3.09	2.05	1.75	1.5	1.31	1.49	1.18	0.57;
1.28	1.62	1.72	1.24	1.11	1.24	1.6	3.18	3.1	1.83	1.72	1.65	1.3	0.89	0.97;
0.73	0.66	1.4	2.01	1.58	1.08	1.02	1.61	1.97	1.58	1.57	1.41	1.55	1	1;
0.51	0.56	0.84	1.21	1.42	1	1.1	1.16	2.02	1.63	1.63	1.39	1.32	0.89	0.77;
0.64	0.43	0.42	0.54	0.89	0.92	0.8	0.82	0.73	1.07	1.69	1.84	1.53	0.71	1.03;
0.47	0.41	0.18	0.26	0.62	0.53	0.8	0.84	0.98	0.55	0.72	1.31	0.94	1.18	0.73;
0.53	0.45	0.37	0.04	0.21	0.26	0.58	0.7	0.51	0.25	0.26	0.84	1.11	1.21	1.27;
0.83	0.83	0.71	0.39	0.6	0.79	0.56	0.88	1.07	0.9	0.96	1.57	1.7	1.39	1.27];

%Make symmetric c matrix;     
c=[polymod(4,4) (polymod(4,5)+polymod(5,4))/2 (polymod(4,6)+polymod(6,4))/2 (polymod(4,7)+polymod(7,4))/2;
   0 polymod(5,5) (polymod(5,6)+polymod(6,5))/2 (polymod(5,7)+polymod(7,5))/2;
   0 0 polymod(6,6) (polymod(6,7)+polymod(7,6))/2;
   0 0 0 polymod(7,7)];
c5 = c+c'-diag(diag(c));

%% Luxembourg

polymod = [2.34	0.88	0.21	0.19	0.11	0.76	1.48	0.72	0.79	0.61	0.27	0.47	0.52	0.24	0.05;
1.05	8.76	1.71	0.25	0.22	1.24	2.24	1.09	1.16	0.28	1.02	0.44	0.35	0.17	0.2;
0.48	1.76	11.65	1.64	0.43	0.96	1.24	0.62	1.53	0.66	0.54	0.16	0.15	0.07	0.18;
0.18	0.52	2.32	11.78	2.89	1.45	0.7	0.36	1.38	1.87	0.46	1.44	0.28	0.1	0.18;
0.35	0.24	0.37	2.13	3.78	1.8	0.85	0.64	0.66	1.34	0.79	0.57	0.52	0.31	0.13;
0.79	0.78	0.36	0.92	2.31	3.08	2.48	1.14	1.44	1.3	1.52	1.25	0.91	0.69	0.33;
1.3	0.94	0.66	0.78	1.48	2.17	3.48	1.72	2.56	1.81	1.65	1.29	1.4	1.03	0.45;
1.45	1.79	1.14	0.94	1.41	1.9	3.11	2.59	2.72	1.75	1.63	1.03	1.28	1.41	0.5;
0.83	1.29	1.6	1.36	1.19	1.41	2.48	2.36	3.54	1.63	1.9	1.09	1.14	1.17	0.65;
0.37	0.57	1.02	1.36	1.67	1.11	1.48	1.84	2.37	2.46	1.97	1.04	0.8	0.69	0.43;
0.33	0.37	0.43	0.69	1.28	1.38	1.24	1	1.37	2.03	2.13	1.06	0.94	0.93	0.35;
0.33	0.33	0.31	0.4	0.52	1.06	0.78	0.74	0.62	0.78	1.19	1.09	0.95	1.07	0.38;
0.4	0.24	0.16	0.13	0.24	0.54	0.28	0.62	0.46	0.46	0.67	0.65	1.12	1.07	0.6;
0.23	0.12	0.21	0.1	0.2	0.27	0.41	0.31	0.5	0.36	0.33	0.43	0.8	1.17	0.58;
0.28	0.27	0.29	0.28	0.43	0.58	0.48	0.26	0.72	0.93	1.4	0.64	1.11	0.93	1.75];

%Make symmetric c matrix;     
c=[polymod(4,4) (polymod(4,5)+polymod(5,4))/2 (polymod(4,6)+polymod(6,4))/2 (polymod(4,7)+polymod(7,4))/2;
   0 polymod(5,5) (polymod(5,6)+polymod(6,5))/2 (polymod(5,7)+polymod(7,5))/2;
   0 0 polymod(6,6) (polymod(6,7)+polymod(7,6))/2;
   0 0 0 polymod(7,7)];
c6 = c+c'-diag(diag(c));

%% Netherlands

polymod = [3.5	1.71	0.25	0.19	0.33	0.57	1	0.92	3	0	0	0.23	0.39	0.12	0.22;
2.47	11.88	1.56	0.19	0	0.5	1.25	1.62	1.14	0.71	0.31	0.08	0.28	0.24	0.29;
0.32	1.06	10.97	2.5	0.08	0	1.5	1	0.71	0.93	0.08	0.31	0.22	0.06	0.2;
0.15	0.24	1.44	9.19	0.83	0.29	1.25	0.08	0.57	0.79	0.46	0.46	0.39	0	0.24;
0.24	0.18	0.16	1.25	2.42	0.57	0.75	0.85	2.29	0.71	2.23	0.85	0.5	0.29	0.29;
0.21	0.88	0.13	0.44	1.58	1.86	2.25	0.62	0.86	1.21	1.85	0.38	0.56	0.41	0.32;
1.26	0.71	0.25	0.44	2.67	1	3.75	1	1.71	0.86	0.85	0.92	0.94	0.18	0.49;
1.15	1.53	0.78	0.75	1.58	0.86	3	3.92	1.29	1.79	1.23	0.69	1.17	0.59	0.71;
0.53	1.76	1.56	0.69	0.67	1.07	2.13	3.08	1.86	2.5	0.38	1.54	0.78	0.65	0.71;
0.24	0.47	0.94	1.38	0.92	0.5	1.63	1.69	1.29	2.21	1.23	1	0.61	0.35	1.24;
0.47	0.47	0.56	0.69	0.83	1.21	0.88	1.62	1.14	1.5	1.31	1.23	1.17	0.24	0.51;
0.38	0.24	0.19	0.31	0.25	0.57	0.25	0.46	0	0.93	0.69	2.38	1.67	0.71	0.51;
0.35	0.41	0.03	0.06	0.08	0.29	0.5	0.92	0.14	0.43	0.38	1.15	1.61	1.12	0.46;
0.29	0.29	0.13	0.13	0	0.14	0.13	0.69	0.14	0	0.31	0.69	0.72	0.82	0.46;
0.24	0.24	0.56	0.56	0.33	0.21	0.63	0.46	0	0.79	0.62	0.23	1.11	1	1.95];

%Make symmetric c matrix;     
c=[polymod(4,4) (polymod(4,5)+polymod(5,4))/2 (polymod(4,6)+polymod(6,4))/2 (polymod(4,7)+polymod(7,4))/2;
   0 polymod(5,5) (polymod(5,6)+polymod(6,5))/2 (polymod(5,7)+polymod(7,5))/2;
   0 0 polymod(6,6) (polymod(6,7)+polymod(7,6))/2;
   0 0 0 polymod(7,7)];
c7 = c+c'-diag(diag(c));

%% Poland

polymod = [1.33	0.57	0.21	0.10	0.21	0.40	0.38	0.23	0.11	0.13	0.31	0.23	0.25	0.20	0.23;
0.83	6.41	1.06	0.29	0.10	0.27	0.74	0.77	0.56	0.16	0.24	0.50	0.27	0.44	0.26;
0.75	1.62	12.71	1.01	0.30	0.25	0.80	0.68	0.69	0.26	0.37	0.42	0.25	0.44	0.34;
0.49	0.41	2.27	12.12	2.13	0.72	0.54	1.29	1.18	1.13	0.94	0.66	0.53	0.60	0.40;
0.69	0.36	0.63	1.69	6.26	2.40	1.16	1.40	1.58	1.44	1.45	1.02	0.66	0.60	0.34;
1.36	0.92	0.84	0.80	2.61	3.43	2.28	2.50	1.81	1.75	1.94	1.37	1.10	1.36	0.26;
1.19	1.42	1.19	0.88	1.59	2.18	2.36	2.68	1.77	1.44	1.61	1.34	1.31	1.40	0.46;
0.85	0.96	1.23	1.06	1.13	1.43	1.64	3.08	1.76	1.33	1.24	1.06	1.02	1.08	0.71;
0.44	0.68	0.96	1.17	1.11	1.37	1.44	1.87	2.47	1.49	1.71	0.98	1.07	1.68	0.74;
0.47	0.59	0.71	0.96	0.98	1.12	1.36	1.52	1.56	2.25	1.74	1.16	0.56	0.92	0.83;
0.57	0.47	0.46	0.51	1.20	1.33	1.11	1.05	1.03	1.56	1.58	1.40	0.56	0.96	0.74;
0.53	0.48	0.28	0.25	0.79	0.77	0.56	0.87	0.68	0.61	0.94	1.95	1.10	0.68	0.54;
0.29	0.32	0.24	0.25	0.34	0.45	0.59	0.58	0.56	0.41	0.52	0.84	1.12	0.48	0.57;
0.26	0.18	0.15	0.20	0.10	0.23	0.18	0.53	0.34	0.31	0.19	0.56	0.64	0.72	0.54;
0.28	0.36	0.38	0.23	0.30	0.40	0.30	0.71	0.55	0.67	0.71	0.77	0.64	0.80	1.23];

%Make symmetric c matrix;     
c=[polymod(4,4) (polymod(4,5)+polymod(5,4))/2 (polymod(4,6)+polymod(6,4))/2 (polymod(4,7)+polymod(7,4))/2;
   0 polymod(5,5) (polymod(5,6)+polymod(6,5))/2 (polymod(5,7)+polymod(7,5))/2;
   0 0 polymod(6,6) (polymod(6,7)+polymod(7,6))/2;
   0 0 0 polymod(7,7)];
c8 = c+c'-diag(diag(c));

%% 3 age groups

% 15-19, 20-24, 25-30 
% Note that the 25-30 age group based on 25-29 year olds from polymod;

c=cell(3,3);
for j=1:3
for i=1:3
c{i,j}=[c1(i,j) c2(i,j) c3(i,j) c4(i,j) c5(i,j) c6(i,j) c7(i,j) c8(i,j)];
minc(i,j)=min(c{i,j});
maxc(i,j)=max(c{i,j});
avgc(i,j)=mean(c{i,j});
end
end

c=avgc
%% For 4 age groups, uncomment the script below.

%15-19, 20-24, 25-29, 30;

% c=cell(4,4)
% for j=1:4
% for i=1:4
% c{i,j}=[c1(i,j) c2(i,j) c3(i,j) c4(i,j) c5(i,j) c6(i,j) c7(i,j)];
% minc(i,j)=min(c{i,j})
% maxc(i,j)=max(c{i,j})
% avgc(i,j)=mean(c{i,j})
% end
% end


